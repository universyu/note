
## 硬阴影

要么全黑完全看不见，要么不在阴影之中

## 软阴影

考虑光源的大小，完全看不到光源的地方为本影区域，颜色非常深，可以看到部分光源则为半影区域，颜色较淡

## shadow mapping

用于针对点光源（不考虑光源大小）生成硬阴影

### 光源相机

假设光源处有一个虚拟相机，对场景做光栅化。实际上是记录各个像素点的深度。

### 光栅化

实际的相机观察场景，做真正的光栅化，并把当下位置投影回虚拟相机做的光栅化的图中，获取当下位置可见的深度以及当下位置的实际深度，由此判断当下位置是否在阴影中


## ray casting

### pinhole camera model

视点与像素点的连线视作光线延长至与场景第一个点相交，交点连向光源，得到视角方向和光源方向，同时可以观察在交点和光源之间是否有物体阻挡判断是否为阴影区域，对像素进行着色

#### 求光线与物体交点

假设光线出发点是 O , 方向向量 $\vec{d}$  ，则光线上任一点可以表示为 O + $t \vec{d}$  ，让其坐标满足几何体的隐式表达方程求得 t 即可。

#### 求光线与三角形交点

##### 平面交点加判断三角形内

先把射线方程带入三角形所在平面求交点，再判断交点是否在三角形内

##### 线性代数方程组求解

用重心坐标表示三角形内的点，射线坐标与之联立，用 Cramer 法则求解交点，最后判断重心坐标三个系数是否都大于零

#### 求光线与 boundinig box 交点

考虑 bounding box 的三套对面所在无限大平面，求出三组进入对面和离开对面的时间 t ，三个时间段取交集，即 $t_{in-max}-t_{out-min}$ 只要满足 $t_{out-min} > 0$  且 $t_{out-min} >t_{in-max}$ （沿着光线射线方向离开包围盒且时间段确实是有效时间段）就说明光线和包围盒有交点

### whitted style ray tracing 

基本原理同 pinhole camera model ， 但是考虑光线折射、反射后与场景的交点。
