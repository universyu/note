
## 光照

### 漫反射光照模型

漫反射点无论从哪个角度观察，得到的结果都是一样的。

假设光照接收点漫反射系数为 $K_{d}$（可以是一个三通道向量表示反射光的RGB）  法向方向向量为 $\vec{n}$  ，到光源的方向向量为 $\vec{l}$  ，两者的夹角为 $\theta$ ，离光源的距离为 r ，考虑点光源，单位距离时强度为 I ，最终接收的光强为 
$$
\displaystyle \frac{K_{d}I{max(0,\cos \theta)}}{r^2}
$$
这里的 cos$\theta$ 用来计算光照经反射的损耗


### 高光模型

假设光照接收点高光系数为 $K_{s}$（可以是一个三通道向量表示RGB，一般可以取白色）  法向方向向量为 $\vec{n}$  ，到视野的方向向量为 $\vec{v}$  ，半程向量 $\vec{h}$ = $\frac{\vec{v}+\vec{l}}{|\vec{v}+\vec{l}|}$ (对角线单位向量) ，离光源的距离为 r ，考虑点光源，单位距离时强度为 I ，不考虑光经过反射的损耗时最终接收的光强为 
$$
\displaystyle \frac{K_{s}I{max(0,\vec{n}\vec{h})}^p}{r^2}
$$
这里的 p 是用来降低 cos 函数的截至角度，p 越大，高光范围越小


## 着色频率

### Flat shading

对各个三角面计算光照进行着色，即只对面求法线并根据漫反射和高光模型计算颜色

### Gouraud shading

对各个三角面的顶点着色，这里顶点的法向量就当作是经过它的所有三角面法向量的面积加权均值

### Phong shading

对每个像素点做着色

、
### 纹理映射

把二维图片映射到三维，三维物体的表面展开即二维图片


## 重心坐标

### 定义

- 在三角形所在平面内的任意一点可以表示为三个顶点的线性组合，组合系数和为 1 
- 三角形内部的点，组合系数都非负

### 性质

- 三角形内部的点，系数与对应顶点对面三角形面积成正比
- 投影后坐标可能变，需要利用三维坐标求重心坐标而不是投影到屏幕后再求

### 纹理双线性插值

纹理图分辨率低时，pixel 可能无法映射到一个 texel ， 这时取其周围四个 texel 的双线性插值。
水平方向做左上、右上，左下、右下的线性插值，然后在竖直方向做线性插值

### Mipmap

#### 纹理图像素过大的问题

透视失真：近小远大，远处的像素点占据的 texel 多

#### 预处理

原图作为第0层，分辨率不断长宽都除以二直到 1x1 这里的额外空间开销只有原图的三分之一

#### 映射

像素点取其上方和右边的像素映射到 uv 坐标系，求出距离最大值作为正方形的边长 L ，取 $\log_{2}L$ 层纹理图可以映射到 1x1 的 texel

#### 层间插值 （三线性插值）

为了防止整数层级跳跃出现分割线，对于非整数层级，取临近的两个层级分别用双线性插值取值，然后层间做线性插值求平均


### 各向异性过滤

为了处理 Mipmap 只能处理正方形区域的缺陷，预处理时对长宽两个方向分别做缩半处理，最后总的额外存储开销是原图的三倍