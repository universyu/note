# 事件循环

## 异步

`js`是单线程语言，运行在渲染主线程，为了防止阻塞，把一些任务交给其他线程，任务结束后将回调函数包装成任务放入消息队列

## 流程简述

无限循环从消息队列取任务执行，没有任务就休眠，其它线程加入任务时唤醒。事件循环（消息循环）是浏览器渲染主线程的工作方式，chrome 开了一个死循环从消息队列中取任务执行。有很多类型的任务，同一类型一定在同一个队列，但同一个队列可以有不同类型的任务。 `W3C`明文规定必须有`微任务队列`作为最高优先级队列，`交互队列`是高优先级队列，`延时队列`（放计时器的回调）优先级中等。先执行全局`JS`代码，然后清空微任务队列，然后按照浏览器自己的规则从不同的队列取任务。



## async/await

代码立刻执行，`await`右边也立刻执行，然后把`await`下面的代码放到微任务队列



## promise

传入的回调函数立刻执行，在`resolve`后把`then`里面的函数放入微任务队列



## 真正的异步

真正想要同时执行多个任务应该用`worker`实现

