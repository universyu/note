# 网络

### 流程

输入域名，解析成ip，然后发送http请求，服务器接收http请求，处理请求（代码在浏览器上不可见），返回数据，客户端接收返回数据，处理数据（解析、渲染） 处理时遇到需要图片、样式等资源则再额外发请求

### DNS

域名系统，在数据库中检索对应的ip，把域名转换成ip地址

### HTTP请求

超文本传输协议，进行明文传输
**http报文**

- 起始行，请求中包含方法（get、post）、资源url、http版本，响应中包含http版本、状态码和状态消息
- 头部字段，请求中有`user-agent`表示浏览器，`X-Forward-For`表示客户端原始ip。响应头部有`cache-control`
- 消息体，请求get没有消息体，post有。响应消息体获得响应

### HTTPS请求

安全超文本传输协议，使用加密算法加密数据
SSL、TLS用安全证书做身份验证且使用公共密钥加密，被拦截了也无法理解内容，因为没有密钥。利用证书可以确保自己连接的是预期的服务器而不是中间人建立的连接。
CA会验证申请服务器运营者的身份，确保公钥确实属于申请者，然后利用自己的私钥对证书进行数字签名，这个签名可以用CA的公钥验证。浏览器和操作系统内置了受信任的根CA的公钥，浏览器收到证书时会检查证书链，验证证书是否由受信任的CA签名，从而保证安全。

### TCP

网络传输控制协议，确保数据按照顺序传输，而且如果数据发送失败，会重新发送
TCP会验证两方的连接，用三次握手来实现验证过程

- SYN：发起连接请求
- SYN  ACK：回应SYN
- ACK：回应SYN  ACK

用四次挥手终止连接

- 客户端向服务器发送FIN
- 服务器发送ACK
- 服务器把剩下的数据发完，然后发送FIN
- 客户端发送ACK

### UDP

网络传输控制协议，无连接，不可靠传输，只负责把数据传出去，开销小

### GET

GET请求是客户端从服务端获取数据，通过url明文传输，被浏览器缓存

### POST

POST请求是客户端向服务端发送数据，数据放在请求体中，不被浏览器缓存

### Cookie

浏览器存储的个人信息，可以被网页用来做偏好设置

### Session

服务端发送Session给浏览器，Session具有ID和会话持续时间，Session的内容会被Cookie保存，浏览器后面再次访问同一个网页时，服务端可以在Cookie里面看到Session的内容校验是否需要重新登录，Session对应的有效期结束后，浏览器也会自动删掉对应的Cookie

### Token

为了防止服务器存储数据过多，它只存储`JWT`的签名密文，发送`JWT`给浏览器

### Http缓存

- 强缓存不向服务器发送请求，直接使用本地的缓存，服务器可以用`Cache-Control`设置缓存的有效期`max-age: ...`  禁止使用本地缓存`no-store` 强制要求本地检查本地缓存`no-cache`
- 协商缓存：客户端向服务器发送请求，获取资源和`ETag` 下次请求时带有请求头`If-None-Match`表示如果`ETag`没变就返回状态码`304`和空响应，如果变了就返回状态码`200`和响应

### OSI7

物理层：电路的维护，通过物理媒介（电缆、光纤）传输原始比特

数据链路层：定义如何格式化数据进行传输

网络层：数据包从源到目的地的传输和路由选择

传输层：端到端的数据传输服务

会话层：会话管理

表示层：数据的表示，编码、加密、转换

应用层：网页浏览

### nodejs事件循环

先执行同步代码，然后按照阶段执行回调函数，每个阶段之间，执行完`nextTick`队列中的所有回调，然后执行微任务队列中的所有回调